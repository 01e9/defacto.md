{# @var \App\Entity\Election election #}
{# @var \App\Repository\Vo\ConstituencyElectionVo[] constituencies #}

{% set mapData = [] %}
{% for c in constituencies %}
    {% if c.constituency.hasMap() %}
        {% set mapData = mapData|merge([{
            lat: c.constituency.map.lat,
            lng: c.constituency.map.lng,
            label: c.constituency.number,
            description: c.constituency.name,
            url: path('constituency_election', {
                slug: c.constituency.slug,
                electionSlug: c.election.slug
            }),
        }]) %}
    {% endif %}
{% endfor %}

<section class="election-statistics" itemscope itemtype="https://schema.org/VoteAction">
    <div class="row">
        <div class="col">
            <h2
                class="text-center h3"
                itemprop="name"
            >
                <span class="fa fa-map-marker-alt mr-3"></span>
                {{- "" -}}
                {{ election.date < date() ? election.theElectedName : election.theName }}
            </h2>
            <p class="text-muted text-center"><small>{{ "text.information_about_constituencies"|trans }}</small></p>
            <meta itemprop="startTime" content="{{ election.date|date('Y-m-d') }}">
            <div class="alert alert-info py-4 mb-0">
                <div class="row">
                    <div class="col mb-3">
                        {% include "app/component/block/constituencies-select.html.twig" with {
                            constituencies: constituencies,
                            placeholder: 'action.choose_constituency_or_click_on_map'|trans
                        } only %}
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="square">
                            <div class="content rounded bg-light map-markers" data-map-markers="{{ mapData|json_encode }}"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

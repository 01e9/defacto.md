{% extends 'bootstrap_4_layout.html.twig' %}

{% block collection_widget %}
    <div class="collection-widget">
        {{ parent() }}
    </div>

    <div class="row">
        <div class="col">
            <button
                type="button"
                class="btn btn-sm btn-light"
                onclick="(function(wrap){
                    var newEl = document.createElement('div'),
                        html = wrap.attributes['data-prototype'].value,
                        counterAttrName = 'data-prototype-counter',
                        counter = 0;

                    wrap.attributes[counterAttrName] || (function(){
                            var attr = document.createAttribute(counterAttrName);
                            attr.value = String(counter);
                            wrap.setAttributeNode(attr);
                        })();
                    wrap.attributes[counterAttrName].value = String(parseInt(wrap.attributes[counterAttrName].value) + 1);

                    newEl.innerHTML = html.replace(/__name__/g, 'new_' + wrap.attributes[counterAttrName].value);
                    newEl.querySelector('legend').remove();
                    wrap.appendChild(newEl.firstChild);
                    })(document.getElementById('{{ form.vars.id }}'))"
            >{{ ('action.add_' ~ form.vars.name)|trans }}</button>
        </div>
    </div>
{% endblock %}

{% block promise_update_widget %}
    {% import _self as macros %}

    <div class="d-none">
        {{ form_row(form.action) }}
    </div>
    <div class="row">
        <div class="col">
            {{ form_row(form.promise) }}
        </div>
        <div class="col">
            {{ form_row(form.status) }}
        </div>
        {% if form.parent.vars.allow_delete %}
            {{ macros.delete_btn_col() }}
        {% endif %}
    </div>
{% endblock %}

{% block constituency_problem_widget %}
    {% import _self as macros %}

    <div class="d-none">
        {{ form_row(form.constituency) }}
    </div>
    <div class="row">
        <div class="col-lg-5">
            {{ form_row(form.election) }}
        </div>
        <div class="col-lg-5">
            {{ form_row(form.problem) }}
        </div>
        <div class="col">
            {{ form_row(form.respondents) }}
        </div>
        {% if form.parent.vars.allow_delete %}
            {{ macros.delete_btn_col() }}
        {% endif %}
    </div>
{% endblock %}

{% block constituency_candidate_widget %}
    {% import _self as macros %}

    <div class="d-none">
        {{ form_row(form.constituency) }}
    </div>
    <div class="row">
        <div class="col-lg-6">
            {{ form_row(form.election) }}
        </div>
        <div class="col">
            {{ form_row(form.politician) }}
        </div>
        {% if form.parent.vars.allow_delete %}
            {{ macros.delete_btn_col() }}
        {% endif %}
    </div>
{% endblock %}

{% block candidate_problem_opinion_widget %}
    {% import _self as macros %}

    <div class="d-none">
        {{ form_row(form.constituency) }}
    </div>
    <div class="row">
        <div class="col-lg-4">
            {{ form_row(form.election) }}
        </div>
        <div class="col-lg-4">
            {{ form_row(form.politician) }}
        </div>
        <div class="col">
            {{ form_row(form.problem) }}
        </div>
        {% if form.parent.vars.allow_delete %}
            {{ macros.delete_btn_col() }}
        {% endif %}
    </div>
    <div class="row">
        <div class="col">
            {{ form_row(form.opinion) }}
        </div>
    </div>
{% endblock %}

{% block promise_source_widget %}
    {% import _self as macros %}

    <div class="d-none">
        {{ form_row(form.promise) }}
    </div>
    <div class="row">
        <div class="col">
            {{ form_row(form.name) }}
        </div>
        <div class="col">
            {{ form_row(form.link) }}
        </div>
        {% if form.parent.vars.allow_delete %}
            {{ macros.delete_btn_col() }}
        {% endif %}
    </div>
{% endblock %}

{% block action_source_widget %}
    {% import _self as macros %}

    <div class="d-none">
        {{ form_row(form.action) }}
    </div>
    <div class="row">
        <div class="col">
            {{ form_row(form.name) }}
        </div>
        <div class="col">
            {{ form_row(form.link) }}
        </div>
        {% if form.parent.vars.allow_delete %}
            {{ macros.delete_btn_col() }}
        {% endif %}
    </div>
{% endblock %}

{% macro delete_btn_col() %}
    <div class="col-auto">
        <label class="form-control-label">&nbsp;</label>
        <div>
            <button type="button" class="btn btn-light"
                    aria-label="Delete" onclick="this.closest('.form-group').remove();">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>
{% endmacro %}

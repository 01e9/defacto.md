{% extends 'app/base.html.twig' %}

{% set politician_photo = promise.mandate.politician.photo
    ? asset('uploads/politicians/' ~ promise.mandate.politician.photo.filename)
    : 'about:blank'
%}

{% block html_class %}bg-dark-pattern{% endblock %}
{% block body_class %}bg-transparent{% endblock %}

{% block main %}
    <div class="container-fluid bg-gray-pattern">
        {% include 'app/component/after-header-space.html.twig' %}
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-5 col-xl-4 mb-3 mb-lg-0">
                    <div class="row promise-made-by">
                        <div class="col">
                            <div class="d-lg-flex align-items-center text-center">
                                <img class="rounded-circle img-fluid mr-0 mr-lg-3 mb-3 mb-lg-0"
                                     src="{{ politician_photo }}"
                                     alt="Politician">
                                <h1 class="h4">
                                    <a href="javascript:void(0)">
                                        {{- promise.mandate.politician.firstName }}
                                        {{ promise.mandate.politician.lastName -}}
                                    </a>
                                    <br>
                                    {{ 'title._promised'|trans }}
                                </h1>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-7 col-xl-8">
                    {% include 'app/component/item/promise.html.twig' with {promise: promise, is_main: true} only %}
                </div>
            </div>
        </div>
        {% include 'app/component/after-header-space.html.twig' %}
    </div>
    <div class="container-fluid py-5 text-light">
        <div class="container">
            <div class="row">
                {% if promise.statusUpdates|length %}
                    <div class="col">
                        <h2 class="h3 text-center">{{ 'title.promise_actions'|trans }}</h2>
                        <div class="promise-status-updates mt-5">
                            {% for statusUpdate in promise.publishedStatusUpdatesSortedByActionDate %}
                                <div class="row align-items-md-center mb-3">
                                    <div class="col-6 col-md-3 col-lg-2">
                                        <span class="h6"
                                              data-toggle="tooltip" data-placement="top"
                                              title="{{ statusUpdate.action.occurredTime|date }}"
                                        >{{ statusUpdate.action.occurredTime|ago }}</span>
                                    </div>
                                    <div class="col-12 col-md-6 col-lg-8 order-last order-md-0 text-center">
                                        <h4>
                                            <a href="javascript:void(0)"
                                               class="text-white">{{ statusUpdate.action.name }}</a>
                                        </h4>
                                    </div>
                                    <div class="col-6 col-md-3 col-lg-2 text-right">
                                        <span class="badge"
                                              style="border: 1px solid {{ statusUpdate.status.color }}; position: relative;">
                                            <span class="h6 text-uppercase">{{ statusUpdate.status.name }}</span>
                                            <span class="fa fa-arrow-up"
                                                  style="position: absolute; top: -1.6em; right: 1em; color: {{ statusUpdate.status.color }};"></span>
                                        </span>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% else %}
                    <div class="col text-center">
                        <h2 class="h3">{{ 'title.promise_no_actions'|trans }}</h2>
                        <p class="h3 pt-5"><span class="fa fa-search"></span></p>
                        <p>{{ 'text.promise_is_monitored'|trans }}</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}